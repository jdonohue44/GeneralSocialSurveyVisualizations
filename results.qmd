# Results

## Abortion

## Affirmative Action

### Which groups of people agree the most on affirmative action? Which differ the most?

```{r}
library(gssr)
library(dplyr)

data(gss_all)
years <- gss_which_years(gss_all, discaff) |> 
  filter(discaff == TRUE)

discaff_years <- pull(years, year)

gss_d = filter(gss_all, year %in% discaff_years)
```

```{r}
library(dplyr)
library(ggplot2)
library(likert)
library(tidyr)
library(forcats)

a <- gss_d |>
  filter(!is.na(as.factor(discaff))) |>
  ggplot(aes(y = haven::as_factor(region), fill = haven::as_factor(discaff))) + 
  geom_bar(position = "fill")

a
```
```{r}
# year_averages <- gss_d |>
#   filter(!is.na(as.factor(discaff))) |>
#   group_by(year, region) |>
#   summarize(avg = mean(discaff))
b <- ggplot(year_averages, aes(x = year, y = avg, color = haven::as_factor(region))) + 
  geom_point()
b
```

## Capital Punishment

### Which groups of people (e.g. gender, age, race) agree the most on capital punishment? Which differ the most? What are possible explanations for this?

```{r}
# Install 'gssr' from 'ropensci' universe
#install.packages('gssr', repos = c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))

# Also recommended: install 'gssrdoc' as well
#install.packages('gssrdoc', repos = c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))

library(gssr)
data <- data(gss_all)

# Which years was cappun asked about?
gss_which_years(gss_all, cappun)

# Panel data
# data("gss_panel06_long")
```


### Have peoples' opinions on capital punishment changed over the past 50 years? How so?

```{r}

```