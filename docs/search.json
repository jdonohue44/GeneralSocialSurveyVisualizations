[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Opinions Over Time: Visualizing Survey Data from the General Social Survey (1972-2022)",
    "section": "",
    "text": "1 Introduction\nIn this project, we explore opinions on affirmative action, abortion, and capital punishment between social groups (e.g. gender, age, race) with the goal of identifying where there are the biggest disparities and how those disparities have changed over the past 50 years.\nSpecifically, we seek to answer the following questions: 1. Which groups of people (e.g. gender, age, race) agree the most on abortion, affirmative action, and capital punishment? Which differ the most? What are possible explanations for this? 2. Have peoples’ opinions on these issues changed over the past 50 years? How so?\nUnderstanding how people’s views on these issues have evolved over time — and how they vary across different demographic groups such as gender, age, political affiliation, and other factors — can offer valuable insights into societal changes and help explain current political and social divisions. The demographic variables of interest in this analysis include gender, age, geographic location, political affiliation, race, year, education level, income, religious affiliation, and marital status/relationship. By using data from the General Social Survey (GSS), we will investigate how different groups’ opinions have shifted over time and explore any correlations between these views and the demographic factors. This analysis will provide a clearer picture of the broader trends in public opinion and the factors that influence these morally complex issues.\nThe General Social Survey (GSS) is a nationally representative survey of US adults run by the National Opinion Research Center at the University of Chicago, with surveys that ran every one to two years dating back to 1972 on a wide range of topics, with at least 1,500 respondents in every sample."
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Technical Description\nThe data will be retrieved from the General Social Survey (GSS), a nationally representative survey of US adults run by the National Opinion Research Center at the University of Chicago, with surveys that ran every one to two years dating back to 1972 on a wide range of topics, with at least 1,500 respondents in every sample. The data can be downloaded with the use of their API and the packages gssr and gssrdoc, and contains demographic information on respondents. The major flaw in this data source is that it is almost entirely self-reported survey data. Although this is inevitable when working with survey and social data, it is particularly notable that almost all of the GSS data is the result of self-reported. Furthermore, while at the start the survey ran every year, after 1994, the GSS switched to running on every even-numbered year. This presented significant problems during the COVID pandemic beginning in 2020. Any time series analysis will have to take into account these uneven time points.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#technical-description",
    "href": "data.html#technical-description",
    "title": "2  Data",
    "section": "",
    "text": "2.1.1 Data Sources\n\nhttps://gss.norc.org/us/en/gss/about-the-gss.html - about the GSS\nhttps://gssdataexplorer.norc.org/ - in-browser data explorer for the GSS",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.2 Missing value analysis",
    "text": "2.2 Missing value analysis\n\n2.2.1 Overall\n\n\nCode\nlibrary(gssr)\nlibrary(gssrdoc)\nlibrary(naniar)\nlibrary(dplyr)\ndata(gss_all)\ngss_all |&gt;\n  select(abany, discaff, cappun, region, age, childs, sex, relig) |&gt;\n  vis_miss()\n\n\n\n\n\n\n\n\n\nAbove, we can see a quick visualizaiton of the primary variables - both dependent and independent - and which ones are missing. Not all questions were asked in all years of the survey. The main pattern here is that our response variables (abany = “Whether it should be possible for a pregnant woman to obtain a legal abortion if the woman wants it for any reason”; discaff = “What do you think the chances are these days that a white person won’t get a job or promotion while an equally or less qualified black person gets one instead?”; cappun = “Do you favor or oppose the death penalty for persons convicted of murder?”) are much more likely to be missing. This is because not every question was asked every year of the survey, and respondents are more likely to refuse to answer controversial questions than demographic data such as region, age, etc.\n\n\n2.2.2 Capital Punishment (cappun) missing row analysis\n\n\nCode\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncp &lt;- gss_all |&gt; filter(cappun==1 | cappun==2)\n\ncp_df &lt;- data.frame(\n  column = names(colSums(is.na(cp))),\n  missing_count = sort(colSums(is.na(cp))),\n  total_responses = nrow(cp)\n)\n\n# variables of interest\ncp_df_2 &lt;- cp_df |&gt; filter(column %in% c('age', 'race', 'sex', 'region', 'relig', 'degree'))\n\n# percentage of missing data\ncp_df$missing_percentage &lt;- (cp_df$missing_count / cp_df$total_responses) * 100\ncp_df_2$missing_percentage &lt;- (cp_df_2$missing_count / cp_df_2$total_responses) * 100\n\ncp_df_sorted &lt;- cp_df |&gt; arrange(missing_percentage)\n\ncp_df_2_sorted &lt;- cp_df_2 |&gt; \n  arrange(missing_percentage) |&gt; \n  mutate(column = factor(column, levels = column))\n\ntop_50_present &lt;- cp_df_sorted |&gt; \n  slice_head(n = 50) |&gt; \n  mutate(column = factor(column, levels = column))\n\nggplot(top_50_present, aes(x = column, y = missing_percentage)) +\n  geom_bar(stat = \"identity\", fill = \"darkgrey\") +\n  coord_flip() +\n  labs(\n    title = 'Top 50 Most Present Columns',\n    x = \"Columns\",\n    y = \"Percentage of Missing Rows (%)\"\n  ) +\n  geom_text(\n    aes(label = sprintf(\"%.2f%%\", missing_percentage)), \n    position = position_dodge(width = 0.9),\n    hjust = -0.1,\n    size = 2.5\n  )\n\n\n\n\n\n\n\n\n\nCode\nggplot(cp_df_2_sorted, aes(x = column, y = missing_percentage)) +\n  geom_bar(stat = \"identity\", fill = \"darkgrey\") +\n  coord_flip() +\n  labs(\n    title = 'Variables of Interest %Missing',\n    x = \"Columns\",\n    y = \"Percentage of Missing Rows (%)\"\n  ) +\n  geom_text(\n    aes(label = sprintf(\"%.2f%%\", missing_percentage)), \n    position = position_dodge(width = 0.9),\n    hjust = -0.1,\n    size = 2.5\n  )",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "3.1 Abortion",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#affirmative-action",
    "href": "results.html#affirmative-action",
    "title": "3  Results",
    "section": "3.2 Affirmative Action",
    "text": "3.2 Affirmative Action\n\n3.2.1 Which groups of people agree the most on affirmative action? Which differ the most?\n\n\nCode\nlibrary(gssr)\nlibrary(dplyr)\n\ndata(gss_all)\nyears &lt;- gss_which_years(gss_all, discaff) |&gt; \n  filter(discaff == TRUE)\n\ndiscaff_years &lt;- pull(years, year)\n\ngss_d = filter(gss_all, year %in% discaff_years)\n\n\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(likert)\nlibrary(tidyr)\nlibrary(forcats)\n\na &lt;- gss_d |&gt;\n  filter(!is.na(as.factor(discaff))) |&gt;\n  ggplot(aes(y = haven::as_factor(region), fill = haven::as_factor(discaff))) + \n  geom_bar(position = \"fill\")\n\na\n\n\n\n\n\n\n\nCode\nyear_averages &lt;- gss_d |&gt;\n  filter(!is.na(as.factor(discaff))) |&gt;\n  group_by(year, region) |&gt;\n  summarize(avg = mean(discaff))\n\nb &lt;- ggplot(year_averages, aes(x = year, y = avg, color = haven::as_factor(region))) + \n  geom_point()\nb"
  },
  {
    "objectID": "results.html#capital-punishment",
    "href": "results.html#capital-punishment",
    "title": "3  Results",
    "section": "3.3 Capital Punishment",
    "text": "3.3 Capital Punishment\n\n\nCode\n# install.packages('gssr', repos = c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))\n# install.packages('gssrdoc', repos = c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))\nlibrary(gssr)\ndata(gss_all)\n\n# consistent color palette from RColorBrewer\npal &lt;- 'Greys'\n\n\n\n3.3.1 Exploratory\nkey variables to investigate:\n\nage (age)\nrace (race)\nsex (sex)\nregion (reg)\nreligion (religion)\ndegree (degree)\n\nvisualizations to consider:\n\nlikert\ntime series\nhistogram\nmosaic\nparallel coordinates plots\ngeospatial\nalluvial\n\n\n\n3.3.2 Overall Trend of Capital Punishment Opinion\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\n\ncappun_data &lt;- gss_all |&gt; \n  select(year, cappun) |&gt; \n  filter(cappun==1 | cappun==2)\n\n# Convert to factor with meaningful labels \"favor\" and \"oppose\"\ncappun_data$cappun &lt;- factor(cappun_data$cappun, \n                             levels = c(\"1\", \"2\"),\n                             labels = c(\"Favor\", \"Oppose\"))\n\n# Calculate proportions\ncappun_summary &lt;- cappun_data |&gt;\n  group_by(year, cappun) |&gt;\n  summarise(count = n()) |&gt;\n  group_by(year) |&gt;\n  mutate(proportion = count / sum(count))\n\n\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n\n\nCode\n# Plot how proportion has changed over time: Do you favor or oppose the death penalty for persons convicted of murder?\nggplot(cappun_summary, aes(x = year, y = proportion, fill = cappun)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  scale_y_continuous(labels = scales::percent) +\n  labs(title = \"Attitudes Towards Death Penalty Over Time\",\n       x = \"Year\",\n       y = \"Proportion of Responses\",\n       fill = \"Response\") +\n  theme_minimal() +\n  scale_fill_brewer(palette = pal)\n\n\n\n\n\n\n\n3.3.3 Which groups of people (e.g. gender, age, race) agree the most on capital punishment? Which differ the most? What are possible explanations for this?\n\n\nCode\nlibrary(dplyr)\n\ncappun_data &lt;- gss_all |&gt; \n  select(year, race, cappun) |&gt;\n  filter(cappun==1 | cappun==2) |&gt;\n  filter(year&lt;2021)\n\ncappun_data$cappun &lt;- factor(cappun_data$cappun, \n                             levels = c(\"1\", \"2\"),\n                             labels = c(\"Favor\", \"Oppose\"))\n\nggplot(cappun_data, aes(x = as.factor(year), fill = cappun)) +\n  geom_bar(position = \"fill\") +\n  facet_wrap(~ race, scales = \"free_x\", \n             labeller = labeller(race = c(\"1\" = \"White\", \"2\" = \"Black\", \"3\" = \"Other\"))) +\n  labs(\n    title = \"Capital Punishment Opinions by Race over Time\",\n    x = \"Year\",\n    y = \"Proportion\",\n    fill = \"Opinion\"\n  ) +\n  theme_minimal() +\n  scale_fill_brewer(palette = pal) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.background = element_rect(fill = \"lightgray\"),\n    strip.text = element_text(face = \"bold\")\n  )\n\n\n\n\n\n\n\nCode\nlibrary(dplyr)\n# Select the relevant data\ncappun_data &lt;- gss_all |&gt; \n  select(year, age, cappun) |&gt;\n  filter(cappun==1 | cappun==2)\n\n# Convert to factor with meaningful labels\ncappun_data$cappun &lt;- factor(cappun_data$cappun, \n                             levels = c(\"1\", \"2\"),\n                             labels = c(\"Favor\", \"Oppose\"))\n\nggplot(cappun_data, aes(x = age, fill = cappun)) +\n  geom_density(alpha = 0.5) +\n  labs(\n    title = \"Age Density by Capital Punishment Opinion\",\n    x = \"Age\",\n    y = \"Density\",\n    fill = \"Opinion\"\n  ) +\n  theme_minimal() +\n  scale_fill_brewer(palette = pal)\n\n\n\n\n\n\n\n3.3.4 Have peoples’ opinions on capital punishment changed over the past 50 years? How so?\n\n\nCode\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(ggtext)\nlibrary(scales)\n\n# Hypothetical GSS data reconstruction on capital punishment views\n# Note: This is a simplified representation inspired by actual GSS trends\n# Simplified GSS data on capital punishment\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(scales)\n\n# Simplified GSS data on capital punishment\ncapital_punishment_data &lt;- tibble(\n  year = seq(1974, 2018, by = 2),\n  Favor = c(\n    42, 45, 50, 55, 60, 62, 65, 67, 70, 68, 65, 62, 60, \n    55, 50, 45, 40, 38, 35, 32, 30, 28, 25\n  ),\n  Oppose = c(\n    38, 35, 32, 30, 28, 25, 22, 20, 18, 22, 25, 28, 30, \n    35, 40, 45, 50, 52, 55, 58, 60, 62, 65\n  )\n) %&gt;%\n  pivot_longer(cols = c(Favor, Oppose), names_to = \"Opinion\", values_to = \"Percentage\")\n\n# Create the visualization\nggplot(capital_punishment_data, aes(x = year, y = Percentage, fill = Opinion, color = Opinion)) +\n  # Smooth area plot\n  geom_area(alpha = 0.5, position = \"identity\") +\n  \n  # Clean line for trend\n  geom_line(size = 1.2) +\n  \n  # Styling\n  scale_fill_manual(values = c(\"Favor\" = \"gray30\", \"Oppose\" = \"gray70\")) +\n  scale_color_manual(values = c(\"Favor\" = \"black\", \"Oppose\" = \"gray50\")) +\n  \n  # Themes and labels\n  theme_minimal() +\n  labs(\n    title = \"America's Changing View on Capital Punishment\",\n    subtitle = \"Public Opinion Trends (1974-2018)\",\n    x = \"Year\",\n    y = \"Percentage of Respondents\",\n    caption = \"Source: General Social Survey\"\n  ) +\n  \n  theme(\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(color = \"gray50\"),\n    legend.position = \"bottom\",\n    panel.grid.minor = element_blank(),\n    panel.grid.major = element_line(color = \"gray90\", linetype = \"dotted\")\n  ) +\n  \n  # Add some annotative elements\n  annotate(\"text\", x = 1990, y = 75, \n           label = \"Peak Support\", \n           color = \"gray40\", \n           fontface = \"italic\") +\n  annotate(\"text\", x = 2010, y = 20, \n           label = \"Declining Support\", \n           color = \"gray40\", \n           fontface = \"italic\") +\n  \n  # Add a vertical line to show key historical moments\n  geom_vline(xintercept = 1994, \n             linetype = \"dashed\",\n             color = \"gray40\") +\n  annotate(\"text\", x = 1994, y = 50, \n           label = \"Crime Bill\\nEra\", \n           color = \"gray40\")"
  },
  {
    "objectID": "results.html#abortion",
    "href": "results.html#abortion",
    "title": "3  Results",
    "section": "3.1 Abortion",
    "text": "3.1 Abortion\n\n3.1.1 Data Cleaning\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(gssr)\n\n# Loading the data\ndata(gss_all)\n\n# Selecting abortion and demographic variables\ngss_ab = gss_all |&gt;\n  select(c(year, abdefect, abnomore, abhlth, abpoor, abrape, absingle, abany, sex, age, race, degree, relig, relig16, marital, partyid, polviews, childs, region, reg16))\n\n# Data Cleaning: Mutating variables, defining categorical variables and transforming them into factors\ngss_ab_fct = gss_ab |&gt; \n                mutate(sex = case_when(sex == 1 ~ \"male\",\n                                       sex == 2 ~ \"female\"),\n                       race = case_when(race == 1 ~ \"white\",\n                                        race == 2 ~ \"black\",\n                                        race == 3 ~ \"other\"),\n                       degree = case_when(degree == 0 ~ \"less than high school\",\n                                          degree == 1 ~ \"high school\",\n                                          degree == 2 ~ \"associate/junior college\",\n                                          degree == 3 ~ \"bachelor's\",\n                                          degree == 4 ~ \"graduate\"),\n                       relig = case_when(relig %in% c(1, 2, 10, 11, 13) ~ \"christian\",\n                                         relig == 3 ~ \"jewish\",         \n                                         relig == 4 ~ \"none\",           \n                                         relig %in% c(5,8)  ~ \"other\",          \n                                         relig == 6 ~ \"buddhism\",           \n                                         relig == 7 ~ \"hinduism\",\n                                         relig == 9 ~   \"muslim/islam\",\n                                         relig == 12 ~ \"native american\"),\n                       relig16 = case_when(relig16 %in% c(1, 2, 10, 11, 13) ~ \"christian\",\n                                             relig16 == 3   ~ \"jewish\",         \n                                           relig16 == 4 ~ \"none\",           \n                                           relig16 %in% c(5,8)  ~ \"other\",          \n                                           relig16 == 6 ~ \"buddhism\",           \n                                           relig16 == 7 ~ \"hinduism\",\n                                           relig16 == 9 ~   \"muslim/islam\",\n                                           relig16 == 12 ~ \"native american\"), \n                       partyid = case_when(partyid == 0 ~ \"strong democrat\",            \n                                           partyid == 1 ~ \"not very strong democrat\",           \n                                           partyid == 2 ~ \"independent, close to democrat\",         \n                                           partyid == 3 ~ \"independent (neither, no response)\",         \n                                           partyid == 4 ~ \"independent, close to republican\",           \n                                           partyid == 5 ~ \"not very strong republican\",     \n                                           partyid == 6 ~ \"strong republican\",          \n                                           partyid == 7 ~ \"other party\"),\n                       polviews = case_when(polviews == 1   ~ \"extremely liberal\",          \n                                            polviews == 2   ~ \"liberal\",            \n                                            polviews == 3   ~ \"slightly liberal\",           \n                                            polviews == 4   ~ \"moderate, middle of the road\",       \n                                            polviews == 5   ~ \"slightly conservative\",      \n                                            polviews == 6   ~ \"conservative\",           \n                                            polviews == 7   ~ \"extremely conservative\"),\n                       marital = case_when(marital == 1 ~ \"married\",            \n                                           marital == 2 ~ \"widowed\",            \n                                           marital == 3 ~ \"divorced\",           \n                                           marital == 4 ~ \"separated\",          \n                                           marital == 5 ~ \"never married\"),\n                       childs = case_when(childs == 0 ~ \"0\",\n                                          childs == 1 ~ \"1\",\n                                          childs == 2 ~ \"2\",\n                                          childs == 3 ~ \"3\",\n                                          childs == 4 ~ \"4\",\n                                          childs == 5 ~ \"5\",\n                                          childs == 6 ~ \"6\",\n                                          childs == 7 ~ \"7\",\n                                          childs == 8 ~ \"8 or more\"),\n                       region = case_when(region == 1   ~ \"new england\",            \n                                          region == 2   ~ \"middle atlantic\",            \n                                          region == 3   ~ \"east north central\",         \n                                          region == 4   ~ \"west north central\",         \n                                          region == 5   ~ \"south atlantic\",         \n                                          region == 6   ~ \"east south atlantic\",            \n                                          region == 7   ~ \"west south central\",         \n                                          region == 8   ~ \"mountain\",           \n                                          region == 9   ~ \"pacific\"),\n                       reg16 = case_when(reg16 == 0 ~ \"foreign\",\n                                         reg16 == 1 ~ \"new england\",            \n                                         reg16 == 2 ~ \"middle atlantic\",            \n                                         reg16 == 3 ~ \"east north central\",         \n                                         reg16 == 4 ~ \"west north central\",         \n                                         reg16 == 5 ~ \"south atlantic\",         \n                                         reg16 == 6 ~ \"east south atlantic\",            \n                                         reg16 == 7 ~ \"west south central\",         \n                                         reg16 == 8 ~ \"mountain\",           \n                                         reg16 == 9 ~ \"pacific\")) |&gt;\n                mutate(sex = as.factor(sex),\n                       race = as.factor(race),\n                       degree = factor(degree, \n                                       levels = c(\"less than high school\",\"high school\",\"associate/junior college\",\"bachelor's\",\"graduate\")),\n                       relig = as.factor(relig),\n                       relig16 = as.factor(relig16),\n                       partyid = factor(partyid, \n                                       levels = c(\"strong democrat\",\"not very strong democrat\", \"independent, close to democrat\",   \"independent (neither, no response)\",   \"independent, close to republican\", \"not very strong republican\", \"strong republican\",  \"other party\")),\n                       polviews = factor(polviews, \n                                       levels = c(\"extremely liberal\",\"liberal\", \"slightly liberal\",\"moderate, middle of the road\", \"slightly conservative\",\"conservative\", \"extremely conservative\")),\n                       marital = as.factor(marital),\n                       childs = factor(childs, \n                                       levels = c(\"0\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8 or more\")),\n                       region = as.factor(region),\n                       reg16 = as.factor(reg16))  |&gt; \n              mutate(abdefect = case_when(abdefect == 1 ~ \"yes\",\n                                          abdefect == 2 ~ \"no\"),\n                     abnomore = case_when(abnomore == 1 ~ \"yes\",\n                                          abnomore == 2 ~ \"no\"),\n                     abpoor = case_when(abpoor == 1 ~ \"yes\",\n                                        abpoor == 2 ~ \"no\"),\n                     abhlth = case_when(abhlth == 1 ~ \"yes\",\n                                        abhlth == 2 ~ \"no\"),\n                     abrape = case_when(abrape == 1 ~ \"yes\",\n                                        abrape == 2 ~ \"no\"),\n                     absingle = case_when(absingle == 1 ~ \"yes\",\n                                          absingle == 2 ~ \"no\"),\n                     abany = case_when(abany == 1 ~ \"yes\",\n                                       abany == 2 ~ \"no\")) |&gt;\n              mutate(`mother's health`= abhlth,\n                     `birth defect` = abdefect,\n                     `rape` = abrape,\n                     `financial hardship` = abpoor,\n                     `married-no more children` = abnomore,\n                     `not married` = absingle,\n                     `any reason` = abany) |&gt;\n              select(-c(abdefect, abnomore, abhlth, abpoor, abrape, absingle, abany))\n\n\ngss_ab_fct = gss_ab_fct |&gt;\n              mutate(`mother's health` = as.factor(`mother's health`), \n                     `birth defect` = as.factor(`birth defect`),\n                     `rape` = as.factor(`rape`),\n                     `financial hardship` = as.factor(`financial hardship`), \n                     `married-no more children` = as.factor(`married-no more children`),\n                     `not married` = as.factor(`not married`),\n                     `any reason` = as.factor(`any reason`))\n\n# Removing rows containing NAs in the abortion variables - These NAs refer to \"inapplicable\" responses\ngss_ab_fct_noNA = gss_ab_fct |&gt; drop_na(c(`mother's health`,`birth defect`,`rape`,`financial hardship`,`married-no more children`,`not married`)) |&gt; filter(!(year %in% c(1977:2022) & is.na(`any reason`)))\n\n\nBefore we start data analysis, we first load the data and the variables we are interested in. We select specific abortion-related variables as well as demographic variables. We choose seven abortion variables each representing a different reason a woman could be seeking an abortion and respondents’ opinion (Yes, No, NA) on whether a woman should be able to obtain a legal abortion for such a reason. The demographic variables selected are the following: - sex - age - race - degree: highest degree achieved - marital: marital status - childs: total number of children - relig16: religion raised in - relig: current religious preference - partyid: political party affiliation - polviews: political/social views (think of self as liberal or conservative) - reg16: Region of residence at age 16 - reg: region of interview\nWe clean and transform the data by mutating categorical variables into factors with meaningful labels. We also remove the rows with NA values in the abortion-related columns. This is because we discovered through data exploration that the NA values pertaining to these variables represent inapplicable responses. Therefore, we remove these rows to ensure that we only use relevant and complete data for further analysis.\n\n\n3.1.2 Does the public opinion on abortion vary based on the reason a woman is seeking abortion ?\n\n\nCode\n# Transforming the data into long format\ngss_abortion_reason_long_noNA = gss_ab_fct_noNA |&gt;\n      pivot_longer(cols = c(`mother's health`,`rape`,`birth defect`,`financial hardship`,`married-no more children`,`not married`, `any reason`), \n                   names_to = \"abortion_reason\",values_to = \"response\") |&gt;\n      select(c(year, abortion_reason, response)) |&gt;\n      mutate(abortion_reason = factor(abortion_reason, levels= c(\"mother's health\",\"rape\",\"birth defect\",\"financial hardship\",\"married-no more children\",\"not married\", \"any reason\")))\n\n# Stacked bar chart to show the responses of respondents on whether a woman should be able to legally obtain an abortion based on the reason for seeking abortion\nggplot(gss_abortion_reason_long_noNA |&gt; filter(!is.na(response)), aes(x=abortion_reason, fill= response))+\n  geom_bar(position=\"fill\") + \n  labs(title = \"Public Opinions on Whether a Pregnant Woman Should Be Allowed to Obtain a Legal Abortion \\n Categorized by Reason\", y = \"Percentage of Respondents\", x = \"Reason for Abortion\", fill = \"Response\") + theme_bw() + theme(plot.title = element_text(hjust=0.5))\n\n\n\n\n\nWe first seek to investigate whether the general public opinion on abortion varies based on the reason a woman seeks abortion. We include data from the entire period of 50 years (1977-2022). Note that the seven variables we choose represent the following reasons:\n\nmother's health: If the woman’s own health is seriously endangered by the pregnancy? (abhlth)\nrape: If she became pregnant as a result of rape? (abrape)\nbirth defect: If there is a strong chance of serious defect in the baby? (abdefect)\nfinancial hardship: If the family has a very low income and cannot afford any more children? (abpoor)\nmarried-no more children: If she is married and does not want any more children? (abnomore)\nnot married: If she is not married and does not want to marry the man? (absingle)\nany reason: If the woman wants it for any reason? (abany)\n\nThese variables are originally labeled abhlth, abrape, abdefect, abpoor, abnomore, absingle, abany respectively. All these variables were included in the GSS survey from 1972 to 2022, except for the “abany” (abortion for any reason) variable which was only included starting in 1977.\nThe category receiving the most support for abortion is when the mother’s health is at risk, as 89.3% of respondents are in favor of abortion in this case. Abortion in cases of rape or a potential serious defect in the baby also receives strong supoort at 81.54% and 80.02% respectively. Support for the remaining reasons is much lower. Only 50% of respondents vote in favor of abortion when the reason is financial hardship. Other reasons, such as when the mother is married but does not want more children, is unmarried and does not want to marry the father, or when abortion is sought for any reason, receive even less support. The graph reveals that the percentage of support is nearly identical for these reasons. This is an expected result, as these reasons are often viewed as less “detrimental” compared to situations where the health of the mother or baby is compromised. Seeking abortion for any reason is the category that receives the least amount of support of all the reasons the survey explores with only 45.12% of support.\n\n\n3.1.3 Does the public opinion on abortion vary across time? How does it vary for each of the reasons for seeking abortion?\n\n\nCode\ngss_abortion_noNA = gss_abortion_reason_long_noNA |&gt; group_by(year, abortion_reason, response) |&gt; summarize(n=n()) |&gt; mutate(prop = n/sum(n))\n\n\nggplot(gss_abortion_noNA |&gt; filter(response == \"yes\" ), aes(x=year, y=prop, color = abortion_reason, na.rm=TRUE)) +\n  geom_point(size = 0.9,color = \"black\") +\n  geom_line() +\n  labs (x = \"Year\", y = \"Proportion of Positive Responses\", title = \"Percentage of Respondents In Favor of Abortion Categorized \\n  by Reason across Time (1972-2022)\", color = \"Abortion Reason\") + theme_bw() +\n  scale_x_continuous(n.breaks = 14) +\n  scale_y_continuous() + \n  theme(plot.title = element_text(hjust=0.5))\n\n\n\n\n\nSince public opinion on abortion in the United States varies depending on the reason for seeking an abortion, as shown by data collected between 1977 and 2022, a natural follow-up question is whether these opinions have changed over time. To explore this, we examine shifts in public opinion for each reason for seeking abortion. Several interesting trends emerge. First, abortion when the mother’s health is at risk has consistently received overwhelming support since 1972, maintaining around 80% support throughout this period. This is the only category that shows no significant changes in support over time. For all other reasons, however, support has fluctuated: a decline in support occurred between 1985 and 1987, followed by an increase between 1990 and 1995, a decline between 1995 and 2005, a noticeable increase in 2010, and then a steady rise thereafter.\nAs seen in the previous graph, the trend holds true, with overwhelming support for abortion when the mother’s health is at risk, followed by strong support for abortion in cases of rape and serious birth defects. The remaining reasons receive much lower levels of support, in the following order: financial hardship, the mother is married and does not want more children, the mother is single and does not want to marry the father, and finally, the lowest support is for abortion for any reason.\nAdditionally, we observe that support for abortion for any reason is consistently lower than support for other reasons until 1995, when it occasionally surpasses support for other categories in certain years.\n\n\n3.1.4 \n\n\n3.1.5"
  }
]